{"version":3,"file":"apollo.client.js","sources":["../src/auth/apollo.client.js"],"sourcesContent":["import {path} from 'ramda'\nimport {ApolloClient, createNetworkInterface} from 'react-apollo'\nimport {SubscriptionClient, addGraphQLSubscriptions} from 'subscriptions-transport-ws'\n\nexport default ({\n    baseUrl = 'localhost',\n    useSubscriptionsToo = true,\n    parseTokenFromStorage = true\n} = {}) => { \n    const networkInterface = createNetworkInterface({uri: `http://${baseUrl}/graphql`})\n\n    if (parseTokenFromStorage) {\n        networkInterface.use([{\n            applyMiddleware(req, next) {\n                if (!path(['options', 'headers'], req)) {\n                    req.options.headers = {}\n                }\n                req.options.headers['x-token'] = localStorage.getItem('token')\n                next()\n            }\n        }])\n    }\n\n    if (useSubscriptionsToo) {\n        const wsClient = new SubscriptionClient(`ws://${baseUrl}/subscriptions`, {reconnect: true})\n        return new ApolloClient({\n            networkInterface: addGraphQLSubscriptions(networkInterface, wsClient)\n        })\n    }\n\n    return new ApolloClient({networkInterface})\n}\n"],"names":["baseUrl","useSubscriptionsToo","parseTokenFromStorage","networkInterface","createNetworkInterface","uri","use","req","next","path","options","headers","localStorage","getItem","wsClient","SubscriptionClient","reconnect","ApolloClient","addGraphQLSubscriptions"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAIA,qBAAe,YAIJ;mFAAP,EAAO;4BAHPA,OAGO;QAHPA,OAGO,gCAHG,WAGH;qCAFPC,mBAEO;QAFPA,mBAEO,yCAFe,IAEf;qCADPC,qBACO;QADPA,qBACO,yCADiB,IACjB;;QACDC,mBAAmBC,uBAAuB,EAACC,iBAAeL,OAAf,aAAD,EAAvB,CAAzB;;QAEIE,qBAAJ,EAA2B;yBACNI,GAAjB,CAAqB,CAAC;2BAAA,2BACFC,GADE,EACGC,IADH,EACS;oBACnB,CAACC,KAAK,CAAC,SAAD,EAAY,SAAZ,CAAL,EAA6BF,GAA7B,CAAL,EAAwC;wBAChCG,OAAJ,CAAYC,OAAZ,GAAsB,EAAtB;;oBAEAD,OAAJ,CAAYC,OAAZ,CAAoB,SAApB,IAAiCC,aAAaC,OAAb,CAAqB,OAArB,CAAjC;;;SALa,CAArB;;;QAWAZ,mBAAJ,EAAyB;YACfa,WAAW,IAAIC,kBAAJ,WAA+Bf,OAA/B,qBAAwD,EAACgB,WAAW,IAAZ,EAAxD,CAAjB;eACO,IAAIC,YAAJ,CAAiB;8BACFC,wBAAwBf,gBAAxB,EAA0CW,QAA1C;SADf,CAAP;;;WAKG,IAAIG,YAAJ,CAAiB,EAACd,kCAAD,EAAjB,CAAP;CA1BJ;;;;"}